<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>构建流程 ✨ | 元气Blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/wind.png">
    <meta name="description" content="元气Joe的前端世界">
    
    <link rel="preload" href="/assets/css/0.styles.8a46e3d7.css" as="style"><link rel="preload" href="/assets/js/app.d50c72b0.js" as="script"><link rel="preload" href="/assets/js/2.7285e602.js" as="script"><link rel="preload" href="/assets/js/13.c032609a.js" as="script"><link rel="prefetch" href="/assets/js/10.95e645d2.js"><link rel="prefetch" href="/assets/js/11.7a5bbaab.js"><link rel="prefetch" href="/assets/js/12.0bd756fe.js"><link rel="prefetch" href="/assets/js/14.621e82f0.js"><link rel="prefetch" href="/assets/js/15.2bc7bb03.js"><link rel="prefetch" href="/assets/js/16.7b7424df.js"><link rel="prefetch" href="/assets/js/17.9a2f808e.js"><link rel="prefetch" href="/assets/js/18.2bb036cb.js"><link rel="prefetch" href="/assets/js/19.d8537971.js"><link rel="prefetch" href="/assets/js/20.c8e9e8fe.js"><link rel="prefetch" href="/assets/js/21.efec8fa1.js"><link rel="prefetch" href="/assets/js/22.3385e6bf.js"><link rel="prefetch" href="/assets/js/23.a260f1cf.js"><link rel="prefetch" href="/assets/js/24.69037aca.js"><link rel="prefetch" href="/assets/js/25.ebc4667f.js"><link rel="prefetch" href="/assets/js/26.d355b386.js"><link rel="prefetch" href="/assets/js/27.8c327e12.js"><link rel="prefetch" href="/assets/js/28.98128502.js"><link rel="prefetch" href="/assets/js/29.b35b9692.js"><link rel="prefetch" href="/assets/js/3.efa71162.js"><link rel="prefetch" href="/assets/js/30.d28a8fd7.js"><link rel="prefetch" href="/assets/js/31.2eab1cab.js"><link rel="prefetch" href="/assets/js/32.0acbefde.js"><link rel="prefetch" href="/assets/js/33.35108fd8.js"><link rel="prefetch" href="/assets/js/34.bd1353df.js"><link rel="prefetch" href="/assets/js/4.2ab80d3e.js"><link rel="prefetch" href="/assets/js/5.b6c9c262.js"><link rel="prefetch" href="/assets/js/6.d1cbcbdc.js"><link rel="prefetch" href="/assets/js/7.7f87f0fb.js"><link rel="prefetch" href="/assets/js/8.97df5136.js"><link rel="prefetch" href="/assets/js/9.80311f25.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8a46e3d7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/wind.png" alt="元气Blog" class="logo"> <span class="site-name can-hide">元气Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/folder1/html.html" class="nav-link">
  文章
</a></li><li class="dropdown-item"><!----> <a href="/pages/folder2/test4.html" class="nav-link">
  随笔
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/qq974837057" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/folder1/html.html" class="nav-link">
  文章
</a></li><li class="dropdown-item"><!----> <a href="/pages/folder2/test4.html" class="nav-link">
  随笔
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/qq974837057" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/folder1/html.html" class="sidebar-link">HTML</a></li><li><a href="/pages/folder1/css.html" class="sidebar-link">CSS</a></li><li><a href="/pages/folder1/js.html" class="sidebar-link">JS</a></li><li><a href="/pages/folder1/ts.html" class="sidebar-link">TS</a></li><li><a href="/pages/folder1/browser.html" class="sidebar-link">HTTP与浏览器</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/folder1/security.html" class="sidebar-link">前端安全</a></li><li><a href="/pages/folder1/monitor.html" class="sidebar-link">监控体系</a></li><li><a href="/pages/folder1/performance.html" class="sidebar-link">性能优化</a></li><li><a href="/pages/folder1/design-pattern.html" class="sidebar-link">设计模式和架构</a></li><li><a href="/pages/folder1/refactor.html" class="sidebar-link">代码重构之道</a></li><li><a href="/pages/folder1/nodejs.html" class="sidebar-link">node与前沿</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/folder1/frame-common.html" class="sidebar-link">框架通识</a></li><li><a href="/pages/folder1/frame.html" class="sidebar-link">框架-Vue</a></li><li><a href="/pages/folder1/react.html" class="sidebar-link">框架-React</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>工程化和协作</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/folder1/webpack.html" aria-current="page" class="active sidebar-link">Webpack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#构建流程-✨" class="sidebar-link">构建流程 ✨</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#webpack-config-js-配置" class="sidebar-link">webpack.config.js 配置</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#bundle-chunk-module-分别指什么" class="sidebar-link">bundle，chunk，module 分别指什么</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#loader-和-plugin-的区别-✨" class="sidebar-link">Loader 和 Plugin 的区别 ✨</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#hmr-热更新原理-hot-module-replacement-✨" class="sidebar-link">HMR 热更新原理（hot module replacement）✨</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#webpack-打包体积优化-tree-shaking" class="sidebar-link">webpack 打包体积优化(Tree-shaking)</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#webpack-打包加速优化-缓存-多进程-提取资源-dll-分包-✨" class="sidebar-link">webpack 打包加速优化(缓存 + 多进程 + 提取资源 + DLL 分包) ✨</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#sourcemap-和源码对应原理" class="sidebar-link">sourcemap 和源码对应原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#浏览器查找-map-文件" class="sidebar-link">浏览器查找 map 文件</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#map-文件对应位置原理" class="sidebar-link">map 文件对应位置原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#webpack-在-vue-cli3-的使用" class="sidebar-link">webpack 在 vue cli3 的使用</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#文件指纹" class="sidebar-link">文件指纹</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#vite" class="sidebar-link">vite</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/webpack.html#参考阅读" class="sidebar-link">参考阅读</a></li></ul></li><li><a href="/pages/folder1/normalize.html" class="sidebar-link">前端规范</a></li><li><a href="/pages/folder1/git.html" class="sidebar-link">Git</a></li><li><a href="/pages/folder1/build.html" class="sidebar-link">构建</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>算法与编程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/folder1/algorithm-data.html" class="sidebar-link">数据结构和算法-概念</a></li><li><a href="/pages/folder1/algorithm-sort.html" class="sidebar-link">数据结构和算法-排序专题</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="构建流程-✨"><a href="#构建流程-✨" class="header-anchor">#</a> 构建流程 ✨</h2> <ul><li>简单说
<ul><li>初始化：启动构建，读取与合并配置参数，加载 Plugin，实例化 Compiler</li> <li>编译：从 Entry 出发，针对每个 Module 串行调用对应的 Loader 去翻译文件的内容，再找到该 Module 依赖的 Module，递归地进行编译处理，形成依赖图</li> <li>输出：将编译后的 Module 组合成 Chunk，将 Chunk 转换成文件，输出到文件系统中</li></ul></li> <li>1、初始化参数：拷贝配置文件 webpack.config.js 合并参数，并实例化插件，得到最终 options 对象。</li> <li>2、开始编译：初始化 Compiler 编译对象，传入各插件的 apply 方法，为事件挂载对应的回调，<strong>执行 Compiler 的 run 方法开始编译</strong>，以下是一些关键事件点。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">webpack</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> compiler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Compiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">...</span><span class="token comment">// 检查options,若watch字段为true,则开启watch线程</span>
  <span class="token keyword">return</span> compiler<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
</code></pre></div><ul><li>3、确定入口：根据 entry 找到入口文件</li> <li>4、编译模块：用 <strong>Loader 进行转换</strong>后，再找出对应依赖模块</li> <li>5、完成编译：确定了转换好的内容和它们之间的依赖关系</li> <li>6、输出资源：根据入口和模块 module 的依赖关系，组装成包含多个 module 的 chunk，每个 chunk 转成一个文件并生成 hash，加载到 输出列表【代码优化和功能添加的关键环节】。</li> <li>7、执行输出：根据 output 路径和文件名，写入文件系统。</li> <li>【事件钩子】执行 run 开始编译：过程中触发一些钩子 beforeRun-&gt;run-&gt;beforeCompile-&gt;compile（开始编译）-&gt;make（入口分析依赖）-&gt;seal（构建封装，不可更改）-&gt;afterCompile（完成构建，缓存数据）-&gt;emit （输出 dist 目录），每个节点会触发对应的 webpack 事件，<strong>plugin 插件监听事件</strong>进行对应的处理。</li> <li>【监听事件】编写插件 plugin 的时候，在 apply 中执行<code>compilation.plugin('xxx', callback)</code>绑定对应的监听事件，监听到就会执行特定的逻辑</li> <li>【获取构建文件】<code>compiler.hooks.emit.tap('xxx',(compilation)=&gt;{})</code> 这个钩子可以获取到 emit 阶段的 compilation 对象，compilation.assets 有所有构建好的资源文件，可以方便我们处理</li> <li>compiler 对象是一个全局单例，他负责把控整个 webpack 打包的构建流程。</li> <li>compilation 对象是每一次构建的上下文对象，它包含了当次构建所需要的所有信息，每次热更新和重新构建，compiler 都会重新生成一个新的 compilation 对象，负责此次更新的构建过程。</li></ul> <h2 id="webpack-config-js-配置"><a href="#webpack-config-js-配置" class="header-anchor">#</a> webpack.config.js 配置</h2> <ul><li>配置合并：
<ul><li>在加载插件之前，webpack 将 webpack.config.js 中的各个配置项拷贝到 options 对象中。</li> <li>options 作为最后返回结果，包含了之后构建阶段所需的重要信息。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//入口配置</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//输出配置</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//插件集合(配置文件 + shell指令)</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span> loaders<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//模块配置</span>
    context<span class="token operator">:</span> <span class="token comment">//工程路径</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> node_modules <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> pathToReact <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>node_modules<span class="token punctuation">,</span> <span class="token string">&quot;react/dist/react.min.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 入口文件，是模块构建的起点，同时每一个入口文件对应最后生成的一个 chunk。</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    bundle<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;webpack/hot/dev-server&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;webpack-dev-server/client?http://localhost:8080&quot;</span><span class="token punctuation">,</span>
      path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;app/app.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 文件路径指向(可加快打包过程)。</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      react<span class="token operator">:</span> pathToReact<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 生成文件，是模块构建的终点，包括输出文件与输出路径。</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;build&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">&quot;[name].js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 这里配置了处理各模块的 loader ，包括 css 预处理 loader ，es6 编译 loader，图片处理 loader。</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    loaders<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;babel&quot;</span><span class="token punctuation">,</span>
        query<span class="token operator">:</span> <span class="token punctuation">{</span>
          presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    noParse<span class="token operator">:</span> <span class="token punctuation">[</span>pathToReact<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// webpack 各插件对象，在 webpack 的事件流中执行对应的方法。</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="bundle-chunk-module-分别指什么"><a href="#bundle-chunk-module-分别指什么" class="header-anchor">#</a> bundle，chunk，module 分别指什么</h2> <ul><li><p>Entry：作为构建依赖图的入口文件</p></li> <li><p>Output：输出创建的 bundles 到指定文件夹，默认值为 ./dist。</p></li> <li><p>bundle（包）：webpack 打包出来的文件</p></li> <li><p>chunk（代码块）：由多个模块 module 组合而成，代码分割的产物（如 webpack4 的 SplitChunksPlugin），也就是按需加载的分块。将一些代码单独打包为一个 Chunk ，用于按需加载或缓存。</p></li> <li><p>module（模块）：Webpack 里一切皆模块（图片、ES6 模块）、一个模块对应一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。</p></li> <li><p>module 和 chunk 的图解</p> <p><img src="/assets/img/webpack-chunk.abbd553b.jpg" alt="module和chunk"></p></li></ul> <h2 id="loader-和-plugin-的区别-✨"><a href="#loader-和-plugin-的区别-✨" class="header-anchor">#</a> Loader 和 Plugin 的区别 ✨</h2> <ul><li><p>Loader(加载器)</p> <ul><li>用于文件转换，单一原则，每个 Loader 只做一种&quot;转义&quot;工作。webpack 链式调用每个 loader，从后往前，可以理解为出栈过程。</li> <li>webpack 原生只能解析 js，loader 使 webpack 可以加载和解析非 js 文件(css、图片)</li> <li>用法：module.rules 配置，数组里面每项都是 object，描述了{ test 针对类型、loader 使用什么加载、options 配置的参数 }<div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      loader<span class="token operator">:</span> <span class="token string">&quot;vue-loader&quot;</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> vueLoaderConfig<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      loaders<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sass-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>常见 Loader</p> <ul><li>file-loader：加载文件资源</li> <li>url-loader：小文件以 base64 的方式把文件内容注入到代码中去</li> <li>css-loader：加载 CSS，支持模块化、压缩、文件导入等特性</li> <li>style-loader：把外部 CSS 代码注入到 html 的 head 标签中。</li> <li>sass-loader: sass 语法转换</li> <li>node-sass: sass-loader 依赖需要</li> <li>babel-loader:把 ES6+ 转换成 ES5</li> <li>eslint-loader： ESLint 检查 JavaScript 代码</li></ul></li> <li><p>自己实现一个 loader</p> <ul><li>导出一个函数，这个函数接收 content 匹配到的文件内容，对这些传入的字符串进行处理，然后返回，在 webpack.config.js 的 module.rules 数组里加上一个对象，描述匹配的文件和导入 js 文件和写 options 配置。</li> <li>获取 options 配置：loader-utils 库<code>loaderUtils.getOptions(this)</code></li> <li>返回形式推荐写法：<code>this.callback(null, &quot;{};&quot; + content)</code>两个参数，error + 编译完的 content。</li> <li>异步 loader：使用 async/await</li></ul></li> <li><p>Plugin(插件)</p> <ul><li>用于扩展 webpack 的功能（如代码分割、压缩、定义变量、替换静态资源引用路径）</li> <li>构建过程调用原理：Webpack 会在构建过程中对应的钩子中广播出特定的事件，插件在监听到感兴趣的事件后会执行特定的逻辑，并且插件可以调用 Webpack 提供的 API 改变 Webpack 的输出结果</li> <li>钩子：beforeRun -&gt; run -&gt; beforeCompile -&gt; compile（开始编译）-&gt; make（入口分析依赖）-&gt; seal（构建封装，不可更改）-&gt; afterCompile（完成构建，缓存数据）-&gt; emit （发射 stream，输出 dist 目录）</li> <li>用法：plugins 中单独配置，数组里每项都是一个 plugin 实例，参数由构造函数传入。<div class="language-js extra-class"><pre class="language-js"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">ProgressBarPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>LoaderOptionsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    minimize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p>常见 Plugin</p> <ul><li>terser-webpack-plugin：webpack4 默认的代码压缩插件，默认开启多进程和缓存</li> <li>split-chunks-plugin: 代码分割 （Webpack 4 满足条件会自动拆分 chunk，如默认大于 30kb 的文件、可复用...）</li> <li>define-plugin：定义环境变量（开发环境和生产环境的域名或 API，或全局版本号：通过日期时间计算拼接，代码中直接使用）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token constant">WEIGHT_VERSION</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token function">getPluginVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>banner-plugin: 给每个 chunk 头部添加 banner，如注释</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>BannerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    banner<span class="token operator">:</span> <span class="token string">'// { &quot;framework&quot;: &quot;Vue&quot; }\n'</span><span class="token punctuation">,</span>
    raw<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// banner内容直出，不以注释出现</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><ul><li>html-webpack-plugin：生成 html 文件，里面添加了 JS 文件的 script 标签，还可以设置 loading</li> <li>webpack-bundle-analyzer: 可视化 webpack 输出文件的体积(业务组件、依赖第三方模块)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UglifyJsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;uglifyjs-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      cache<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//缓存</span>
      sourceMap<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//压缩</span>
      parallel<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">//多核</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>webpack-parallel-uglify-plugin: 多核压缩,提高压缩速度</li></ul></li> <li><p>自己实现一个 plugin</p> <ul><li>写一个带 apply(compiler) 方法的 class 类，暴露出去，可以给外部新建 plugin 实例</li> <li>事件流开始的时候，实例化所有插件，执行插件的 apply 方法，在事件流上挂载回调的方法</li> <li>构建过程中钩子广播出事件，然后执行对应回调，改变输出结果</li></ul></li></ul> <h2 id="hmr-热更新原理-hot-module-replacement-✨"><a href="#hmr-热更新原理-hot-module-replacement-✨" class="header-anchor">#</a> HMR 热更新原理（hot module replacement）✨</h2> <ul><li><p><a href="https://zhuanlan.zhihu.com/p/30669007" target="_blank" rel="noopener noreferrer">参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>当你对代码进行修改并保存后，webpack 将对代码重新打包，并将新的模块发送到浏览器端，浏览器通过新的模块替换老的模块，这样在不刷新浏览器的前提下就能够对应用进行更新。</p></blockquote></li> <li><p>在 webpack 的 watch 模式下，文件系统中某一个文件发生修改，对修改的模块重新编译打包。</p></li> <li><p>webpack-dev-middleware 处理打包后的文件存在内存里。</p></li> <li><p>webpack-dev-server 和 webpack-dev-server/client（浏览器端）建立 websocket 长连接，利用这个连接，传递新模块的 hash 和编译打包的状态信息给浏览器。</p></li> <li><p>HMR.runtime 收到新模块的 hash，Jsonp.runtime 向 webpack-dev-server 服务端发送 ajax 请求（携带上一次的 hash，非本次 hash），获取模块更新列表的 manifest.json 描述文件（包含更新模块的最新 hash）再通过 Jsonp 获取最新 hash 对应的模块代码。</p></li> <li><p>HotModulePlugin 进行模块对比，替换模块及更新依赖树 modules tree 引用。</p></li> <li><p>HMR 失败，通过浏览器刷新整个页面获取最新代码。
<img src="/assets/img/webpack-hmr.bed5b8b6.png" alt="webpack-hmr"></p></li> <li><p>疑问：为什么不在 socket 发送更新好的模块代码</p> <ul><li>应该是为了功能解耦</li> <li>dev-server/client 只负责消息传递、不负责新模块的获取</li> <li>HMR runtime 才应该是获取新代码的地方。</li></ul></li></ul> <h2 id="webpack-打包体积优化-tree-shaking"><a href="#webpack-打包体积优化-tree-shaking" class="header-anchor">#</a> webpack 打包体积优化(Tree-shaking)</h2> <ul><li><p>分析打包后的模块文件大小</p> <ul><li>webpack-bundle-analyzer</li></ul> <div class="language- extra-class"><pre class="language-text"><code>npm i -D webpack-bundle-analyzer
npm run build -- --report
</code></pre></div></li> <li><p>Tree-shaking</p> <ul><li>webpack4 默认开启 Tree-shaking（mode 为 production）：清除代码中无用的部分。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> add<span class="token punctuation">,</span> minus <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./math&quot;</span><span class="token punctuation">;</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//minus不会参与构建</span>
</code></pre></div><ul><li><p>原理</p> <ul><li>基于 ES6 modules 的静态检测也就是 import 语法（确保引用的模块都是 ES6 规范）</li> <li>ESM 下模块之间的依赖关系是高度确定的，与运行状态无关，编译工具只需要对 ESM 模块做静态分析，就可以从代码字面量中推断出哪些模块值未曾被其它模块使用。</li> <li>其他模块方式是动态的，很难预测，如：CommonJS 模块是运行时加载，ES6 模块是编译时输出接口，CommonJs 是动态语法可以写在判断里，ES6 Module 静态语法只能写在顶层。</li></ul></li> <li><p>实现：先标记模块导出值哪些没被使用，使用 Terser 删掉这些没用的语句。</p> <ul><li>Make 阶段，收集模块导出变量并记录到模块依赖关系图 ModuleGraph 变量中</li> <li>Seal 阶段，遍历 ModuleGraph 标记模块导出变量有没有被使用</li> <li>生成产物时，若变量没有被其它模块使用则删除对应的导出语句</li></ul></li> <li><p>避免无意义的赋值</p> <ul><li>也就是导入值赋值之后给一个变量后，没有使用</li> <li>而静态分析只是看代码中有没有出现这个变量和有没有被其他模块引用</li> <li>从而导致没有 Tree Shaking 。</li></ul></li> <li><p>导出值的粒度控制</p> <ul><li><p>只用到<code>export default {}</code> 导出值的其中一个属性，整个 default 对象依然会被完整保留。</p></li> <li><p>优化：保持原子性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> bar <span class="token operator">=</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> bar<span class="token punctuation">,</span> foo <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p>防止 Tree Shaking 失效</p> <ul><li><p>禁止 Babel 转译模块导入导出语句：modules: false， webpack 2.0 开始原生支持 ES Module，也就是说不需要 babel 把 ES Module 转换成曾经的 commonjs 模块</p></li> <li><p>失效原因：<strong>使用 babel-loader，将 es6 模块转成 commonjs 了，无法检测</strong></p></li> <li><p>解决：.babelrc 或 webpack.config.js 里设置 <code>modules: false</code> ，避免 module 被转换 commonjs</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// .babelrc</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;modules&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 或者</span>
<span class="token comment">// webpack.config.js</span>
module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">{</span>
                loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                options<span class="token operator">:</span> <span class="token punctuation">{</span>
                    presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> modules<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>，
            exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(node_modules)</span><span class="token regex-delimiter">/</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div></li></ul></li> <li><p>sideEffects: false</p> <ul><li>webpack 4 在 package.json 文件中设置 sideEffects: false 表示模块是无副作用的（是否修改了 window 上的属性，是否复写了原生对象方法等），可以放心进行判断删除。</li> <li>我这个包在设计的时候就是期望没有副作用的，即使他打完包后是有副作用的，webpack 同学你摇树时放心的当成无副作用包摇就好啦！</li> <li>使用：<div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第三方npm模块 的 package.json</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;your-project&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token comment">// 业务代码的 webpack.prod.conf.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(node_modules|bower_components)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                use<span class="token operator">:</span> <span class="token punctuation">{</span>
                    loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                sideEffects<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul></li> <li><p>SplitChunksPlugin 拆包配置，配置 cacheGroups</p> <ul><li>字段
<ul><li>chunks：initial 是将异步和非异步的文件分离，分离页面首次需要加载的包。</li> <li>minSize：文件最小打包体积</li> <li>test：匹配正则打包规则</li> <li>priority：打包优先级，数字越大越优先</li> <li>minChunks： 最少引入次数</li></ul></li> <li>方案
<ul><li>vendors：项目基本框架 react 之类单独打包，首页必须用到的</li> <li>echartsVenodr：体积较大的第三方异步加载包，单独拆出来</li> <li>async-commons：体积一般可以合并的第三方异步加载包，合并为一个</li> <li>commons：同步加载包，引入两次就打包进去</li></ul></li> <li>建议：最大的包保持在 100k 左右，当然也不建议拆的特别小，因为浏览器 http1 一次性支持 6 次下载文件，太多可能会适得其反</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    concatenateModules<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">//分割代码块</span>
      maxInitialRequests<span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token comment">//默认是5</span>
      cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
        vendors<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 基本框架</span>
          chunks<span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
          test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(react|react-dom|react-dom-router|babel-polyfill|mobx)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          priority<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token string">&quot;vendors&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        echartsVenodr<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 异步加载体积较大的echarts包，指定页面需要的时候再异步加载</span>
          test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(echarts|zrender)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          priority<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// 设置高于async-commons，避免打包到async-common中</span>
          name<span class="token operator">:</span> <span class="token string">&quot;echartsVenodr&quot;</span><span class="token punctuation">,</span>
          chunks<span class="token operator">:</span> <span class="token string">&quot;async&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;async-commons&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 其余异步加载包</span>
          chunks<span class="token operator">:</span> <span class="token string">&quot;async&quot;</span><span class="token punctuation">,</span>
          minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token string">&quot;async-commons&quot;</span><span class="token punctuation">,</span>
          priority<span class="token operator">:</span> <span class="token number">90</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        commons<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 其余同步加载包</span>
          chunks<span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
          minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token string">&quot;commons&quot;</span><span class="token punctuation">,</span>
          priority<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>配置 Externals（推荐）：外部引入，将不需要打包的库或静态资源从构建逻辑中剔除，使用 <strong>CDN</strong> 的方式去引用。</p> <ul><li>步骤：在 externals 中配置 key[包名]+value[CDN 全局变量名]，然后在 HTML 中引入 CDN 的 script 标签。就能实现 import 引入了。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.html</span>
<span class="token operator">&lt;</span>script
  src<span class="token operator">=</span><span class="token string">&quot;https://code.jquery.com/jquery-3.1.0.js&quot;</span>
  integrity<span class="token operator">=</span><span class="token string">&quot;sha256-slogkvB1K3VOkzAI8QITxV3VzpOnkeNVsKvtkYLMjfk=&quot;</span>
  crossorigin<span class="token operator">=</span><span class="token string">&quot;anonymous&quot;</span>
<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">//webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  externals<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">//jquery通过script引入之后，全局中即有了 jQuery 变量</span>
    jquery<span class="token operator">:</span> <span class="token string">&quot;jQuery&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>常见 CDN 链接由 host 域名+包名+版本号+路径</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://cdn.bootcss.com/react/16.9.0/umd/react.production.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><ul><li>有些 CDN 服务不稳定，尽量选择成熟的 CDN 服务。</li></ul></li></ul> <h2 id="webpack-打包加速优化-缓存-多进程-提取资源-dll-分包-✨"><a href="#webpack-打包加速优化-缓存-多进程-提取资源-dll-分包-✨" class="header-anchor">#</a> webpack 打包加速优化(缓存 + 多进程 + 提取资源 + DLL 分包) ✨</h2> <ul><li><p>分析工具</p> <ul><li>体积：webpack-bundle-analyzer</li> <li>速度：插件 speed-measure-webpack-plugin 查看 loader 和 plugin 的耗时</li></ul></li> <li><p>优化总结</p> <ul><li>利用缓存：cache-loader 放在其他 loader 前面、loader/plugin 开启 自身的 cache 配置（如 babel-loader/terser-webpack-plugin 默认开启 ）、hard-source-webpack-plugin 提供二次缓存加速效果</li> <li>利用多进程：thread-loader 放在耗时的 loader 前面、TerserWebpackPlugin 默认开启多进程（也不要开太多 worker，有一定启动开销和通信开销）</li> <li>体积优化：Tree-Shaking 基于 ES6 的静态检测删除无用代码、SplitChunksPlugin 拆包 cacheGroups 配置、Externals 基础包用 CDN 引入</li> <li>Dll 打包：先 DllPlugin 预编译，再用 DllReferencePlugin 加载模块。避免反复编译不常变更的第三方库</li> <li>优化搜索时间：loader 的 test 和 include/exclude（比如 babel-loader 排除 node_modules）、 resolve 的 module 模块搜索目录/alias 别名/extensions 后缀</li> <li>提高配置：升级 Webpack 和 Node.js 和机器</li> <li>多项目单仓库时按照页面来拆分多 Entry，每次只需启动一个 Entry</li> <li>Webpack 切换到 Vite</li> <li>vue：关闭生成 sourcemap</li></ul></li> <li><p>提高热更新速度</p> <ul><li>提高热更新速度，上百页 2000ms 内搞定，10 几页面区别不大</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//在.env.development环境变量配置</span>
<span class="token constant">VUE_CLI_BABEL_TRANSPILE_MODULES</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>原理：利用插件，在开发环境中将异步组件变为同步引入，也就是 import()转化为 require()</li> <li>一般页面到达几十上百，热更新慢的情况下需要用到。</li> <li>webpack5 即将发布，大幅提高了打包和编译速度</li></ul></li> <li><p>分析打包时长：</p> <ul><li>速度分析插件<a href="https://www.npmjs.com/package/speed-measure-webpack-plugin" target="_blank" rel="noopener noreferrer">speed-measure-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <img src="/assets/img/webpack-speed.df664a8f.png" alt=""></li></ul> <div class="language- extra-class"><pre class="language-text"><code>npm install --save-dev speed-measure-webpack-plugin
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//vue.config.js</span>
<span class="token comment">//导入速度分析插件</span>
<span class="token keyword">const</span> SpeedMeasurePlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;speed-measure-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//实例化插件</span>
<span class="token keyword">const</span> smp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeedMeasurePlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  configureWebpack<span class="token operator">:</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 这里是自己项目里需要使用到的其他插件</span>
      <span class="token keyword">new</span> <span class="token class-name">yourOtherPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>较耗时：代码的编译或压缩（转化 AST 树 -&gt; 遍历 AST 树 -&gt; 转回 JS 代码）</p> <ul><li>编译 JS、CSS 的 Loader</li> <li>压缩 JS、CSS 的 Plugin</li></ul></li> <li><p>利用缓存：让二次构建时，不需要再去做重复的工作[没有变化的直接使用缓存，速度更快]</p> <ul><li>开启 Loader、压缩插件的 cache 配置【如 babel-loader 的<code>cacheDirectory:true</code>】，uglifyjs-webpack-plugin【如<code>cache: true</code>】，构建完将缓存存放在<code>node_modules/.cache/..</code>。</li> <li><a href="https://www.npmjs.com/package/cache-loader" target="_blank" rel="noopener noreferrer">cache-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：将 loader 的编译结果写入硬盘缓存，再次构建如果文件没有发生变化则会直接拉取缓存,添加在时间长的 loader 的最前面。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.ext$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'cache-loader'</span><span class="token punctuation">,</span> <span class="token operator">...</span>loaders<span class="token punctuation">]</span><span class="token punctuation">,</span>
            include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>利用多进程：充分利用了硬件本身的优势</p> <ul><li><p>thread-loader：添加在此 loader 后面的放入单独的 worker 池里运行，配置简单</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//安装：npm install thread-loader -D</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">//我的项目中,babel-loader耗时比较长，所以我给它配置 thread-loader</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;thread-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;cache-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>多进程压缩</p> <ul><li>默认的 TerserWebpackPlugin（比 uglifyjs 性能更好）：默认开启了多进程和缓存，缓存文件 <code>node_modules/.cache/terser-webpack-plugin</code></li> <li>其他并行压缩插件：
<ul><li>webpack-parallel-uglify-plugin:子进程并发执行把结果送回主进程，多核并行压缩来提升代码压缩速度</li> <li>uglifyjs-webpack-plugin 自带的 parallel：【如<code>parallel: true</code>】配置项开启多核编译</li></ul></li></ul></li> <li><p>happypack(不维护了)：</p> <ul><li>原理：将 Loader 转换分解到多个子进程中去并行处理，子进程处理完成后把结果发送到主进程中，从而减少总的构建时间</li> <li>使用方法：开启系统 CPU 最大线程，通过插件将 loader 包装，暴露 id，直接 module.rules 引用该 id。</li> <li>happypack 默认开启 CPU 核数 - 1 个进程，当然，我们也可以传递 threads 给 happypack。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//安装：npm install happypack -D</span>
<span class="token comment">//引入：const Happypack = require('happypack');</span>
exports<span class="token punctuation">.</span>plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">Happypack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">&quot;jsx&quot;</span><span class="token punctuation">,</span>
    threads<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    loaders<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token keyword">new</span> <span class="token class-name">Happypack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">&quot;styles&quot;</span><span class="token punctuation">,</span>
    threads<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    loaders<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;less-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>module<span class="token punctuation">.</span>rules <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token string">&quot;Happypack/loader?id=jsx&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token string">&quot;Happypack/loader?id=styles&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p>提取公共资源</p> <ul><li>SplitChunksPlugin 进行拆包 cacheGroups 配置</li> <li>配置 Externals（推荐）</li></ul></li> <li><p>DLL 打包</p> <ul><li><p>内置 webpack 的 DllPlugin 编译 和 DllReferencePlugin 引入 dll，避免反复编译，提高打包速度</p></li> <li><p>Vue 全家桶、element-ui、echarts、工具库 lodash 不常变更的依赖 【几十秒】，避免每次构建都进行打包</p></li> <li><p>通过 <strong>DllPlugin</strong> 来对那些我们引用但是不会经常修改的 npm 包来进行预编译</p></li> <li><p>再通过 <strong>DllReferencePlugin</strong> 将预编译的模块加载进来，避免反复编译浪费时间，提高打包速度</p></li> <li><p>步骤：</p> <ul><li>新建一个 webpack.dll.config.js 的配置文件(与 webpack 配置同级)，配置 DllPlugin 插件和打包的库和输出文件的位置</li> <li>package.json 添加 dll 命令，执行 webpack.dll.config.js 文件</li> <li>npm run dll 命令，生成第三方代码集合 js 文件</li> <li>webpack.config.js 里配置 DllReferencePlugin 插件、找到 manifest.json 文件映射到依赖并打包引入</li> <li>修改 index.html，加入 script 标签，写上对应 dll 路径</li> <li>如果更新依赖包，执行<code>npm run dll</code>,新的 dll 文件名便会加上新的 hash</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.config.dll.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        react<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span> <span class="token string">'react-dom'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].dll.[hash:6].js'</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token string">'dll'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        library<span class="token operator">:</span> <span class="token string">'[name]_dll'</span> <span class="token comment">//暴露给外部使用</span>
        <span class="token comment">//libraryTarget 指定如何暴露内容，缺省时就是 var</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">//name和library一致</span>
            name<span class="token operator">:</span> <span class="token string">'[name]_dll'</span><span class="token punctuation">,</span>
            path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token string">'dll'</span><span class="token punctuation">,</span> <span class="token string">'manifest.json'</span><span class="token punctuation">)</span> <span class="token comment">//manifest.json的生成路径</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// package.json 中新增 dll 命令</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;build:dll&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config webpack.config.dll.js&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// npm run build:dll 后，会生成</span>
dist
    └── dll
        ├── manifest<span class="token punctuation">.</span>json
        └── react<span class="token punctuation">.</span>dll<span class="token punctuation">.</span><span class="token number">9</span>dcd9d<span class="token punctuation">.</span>js

<span class="token comment">// manifest.json 用于让 DLLReferencePlugin 映射到相关依赖上。至此 dll 准备工作完成，接下来在 webpack 中引用即可。</span>

<span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//...</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
        contentBase<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            manifest<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token string">'dll'</span><span class="token punctuation">,</span> <span class="token string">'manifest.json'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            cleanOnceBeforeBuildPatterns<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'**/*'</span><span class="token punctuation">,</span> <span class="token string">'!dll'</span><span class="token punctuation">,</span> <span class="token string">'!dll/**'</span><span class="token punctuation">]</span> <span class="token comment">//不删除dll目录</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 修改 public/index.html 文件，在其中引入 react.dll.js</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;/dll/react.dll.9dcd9d.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token comment">// 使用 npm run build 构建，可以看到 bundle.js 的体积大大减少，提高打包速度。</span>
</code></pre></div></li> <li><p>优化搜索时间</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 编译代码的基础配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 项目中使用的 jquery 并没有采用模块化标准，webpack 忽略它</span>
    noParse<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">jquery</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 这里编译 js、jsx</span>
        <span class="token comment">// 注意：如果项目源码中没有 jsx 文件就不要写 /\.jsx?$/，提升正则表达式性能</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(js|jsx)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token comment">// babel-loader 支持缓存转换出的结果，通过 cacheDirectory 选项开启</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;babel-loader?cacheDirectory&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">// 排除 node_modules 目录下的文件</span>
        <span class="token comment">// node_modules 目录下的文件都是采用的 ES5 语法，没必要再通过 Babel 去转换</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置模块导入规则，import/require时会直接在这些目录找文件</span>
    <span class="token comment">// 可以指明存放第三方模块的绝对路径，以减少寻找</span>
    modules<span class="token operator">:</span> <span class="token punctuation">[</span>
      path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>project<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/client/components</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;h5_commonr/components&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// import导入时省略后缀</span>
    <span class="token comment">// 注意：尽可能的减少后缀尝试的可能性</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.jsx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.react.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.json&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// import导入时别名，减少耗时的递归解析操作</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;@compontents&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>project<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/compontents</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p>Vue 关闭在 vue.config.js： <code>module.exports= { productionSourceMap:false （表示生产环境进行代码压缩） }</code></p> <ul><li>优点：构建速度快，体积变小，不需要源码 map 文件，进行代码压缩加密</li> <li>缺点：运行时有错误，无法准确定位哪一行。</li></ul></li> <li><p>更直接</p> <ul><li>升级机器配置</li> <li>升级 webpack5 或 node 版本</li></ul></li> <li><p>效果提升：(20 页)</p> <ul><li>初次打包：20s</li> <li>二次打包：8s</li></ul></li></ul> <h2 id="sourcemap-和源码对应原理"><a href="#sourcemap-和源码对应原理" class="header-anchor">#</a> sourcemap 和源码对应原理</h2> <p>一般来说 source map 的应用都是在监控系统中，开发者构建完应用后，通过插件将源代码及 source map 上传至平台中。一旦客户端上报错误后，我们就可以还原源代码的报错位置，方便开发者快速定位线上问题。</p> <h3 id="浏览器查找-map-文件"><a href="#浏览器查找-map-文件" class="header-anchor">#</a> 浏览器查找 map 文件</h3> <ul><li>开启 source map 选项以后，产物应该为两个文件，分别为 bundle.js 以及 bundle.js.map。</li> <li>sourceMappingURL 表示该文件的 map 地址</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// bundle.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//# sourceMappingURL=bundle.js.map</span>
</code></pre></div><h3 id="map-文件对应位置原理"><a href="#map-文件对应位置原理" class="header-anchor">#</a> map 文件对应位置原理</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// bundle.js.map</span>
<span class="token punctuation">{</span>
  version<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  sources<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;webpack://webpack-source-demo/./src/index.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  names<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'console'</span><span class="token punctuation">,</span> <span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  mappings<span class="token operator">:</span> <span class="token string">'AACAA,QAAQC,IADE'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p>字段解释</p> <ul><li>version：顾名思义，指代了版本号，目前 source map 标准的版本为 3，也就是说这份 source map 使用的是第三版标准产出的</li> <li>file：编译后的文件名</li> <li>sources：多个源文件名</li> <li>names：一个优化用的字段，后续会在 mappings 中用到</li> <li>mappings：这是最重要的内容，表示了源代码及编译后代码的关系，但是先略过这块，下文中会详细解释</li></ul></li> <li><p>映射原理主要是 mapping 字段，使用 Base 64 VLQ 编码，表示压缩代码的位置和源码的位置，通过 AST 的节点描述定位的。</p> <ul><li>英文：有特殊映射关系，比如 A 代表 0、C 代表 1</li> <li>逗号：分割一行代码中的内容</li> <li>分号：换行</li></ul></li> <li><p>每串英文的字母代表一个位置</p> <ul><li>压缩代码的第几列（压缩代码只有一行）</li> <li>哪个源代码文件</li> <li>源码第几行</li> <li>源码第几列</li> <li>names 字段里的索引</li></ul></li></ul> <h2 id="webpack-在-vue-cli3-的使用"><a href="#webpack-在-vue-cli3-的使用" class="header-anchor">#</a> webpack 在 vue cli3 的使用</h2> <ul><li><p>默认 splitChunks 和 minimize</p> <ul><li><p>代码就会自动分割、压缩、优化，</p></li> <li><p>可结合 import 和魔术注释实现代码分割，通过配置对分离出的 chunk 命名</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">(</span>
<span class="token comment">/* webpackChunkName: “my-chunk-name” */</span>
<span class="token string">'./footer'</span>
<span class="token punctuation">)</span>

<span class="token comment">// webpack.config.js</span>
<span class="token punctuation">{</span>
output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> “bundle<span class="token punctuation">.</span>js”<span class="token punctuation">,</span>
    chunkFilename<span class="token operator">:</span> “<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>lazy<span class="token operator">-</span>chunk<span class="token punctuation">.</span>js”
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>可单独拆包配置，如 elementUI</p></li> <li><p>同时 webpack 也会自动帮你 Scope hoisting（变量提升） 和 Tree-shaking</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
<span class="token comment">// ...</span>
    cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
        elementUI<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">&quot;chunk-elementUI&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 单独将 elementUI 拆包</span>
            priority<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token comment">// 权重需大于其它缓存组</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\/]node_modules[\/]element-ui[\/]</span><span class="token regex-delimiter">/</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>默认 CSS 压缩：mini-css-extract-plugin</p> <ul><li>升级：将原先内联写在每一个 js chunk bundle 的 css，单独拆成了一个个 css 文件。</li> <li>css 独立拆包最大的好处就是 js 和 css 的改动，不会影响对方，导致缓存失效。</li> <li>配合 optimization.splitChunks 去拆开打包独立的 css 文件</li></ul></li> <li><p>合并配置：配置 configureWebpack 选项，可为对象或函数(基于环境有条件地配置), 合并入最终的 webpack 配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  configureWebpack<span class="token operator">:</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">MyAwesomeWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 为生产环境修改配置...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 为开发环境修改配置...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>链式操作：修改/新增/替换 Loader，更细粒度的控制其内部配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>module
      <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">&quot;vue&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;vue-loader&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">&quot;vue-loader&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 修改它的选项...</span>
        <span class="token keyword">return</span> options<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h2 id="文件指纹"><a href="#文件指纹" class="header-anchor">#</a> 文件指纹</h2> <ul><li><p>文件指纹是打包后输出的文件名的后缀。</p> <ul><li>hash：和整个项目的构建相关，每次构建都会使 webpack 计算新的 hash</li> <li>chunkhash：和 Webpack 打包的 chunk 有关，不同的 entry 会生出不同的 chunkhash，某个文件的改动只会影响与它有关联的 chunk 的 hash 值，不会影响其他文件</li> <li>contenthash：当文件内容发生变化时，contenthash 发生变化</li></ul></li> <li><p>vue-cli 的指纹默认设置</p> <ul><li>JS：设置 output 的 filename，用 chunkhash。</li> <li>CSS：设置 MiniCssExtractPlugin 的 filename，使用 contenthash，避免和 js 使用共同的 chunkhash，导致改动其中一个，影响到两个。</li> <li>图片：设置 file-loader 的 name，使用 hash。</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span> app<span class="token operator">:</span> <span class="token string">&quot;./scr/app.js&quot;</span><span class="token punctuation">,</span> search<span class="token operator">:</span> <span class="token string">&quot;./src/search.js&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span> filename<span class="token operator">:</span> <span class="token string">&quot;[name][chunkhash:8].js&quot;</span><span class="token punctuation">,</span> path<span class="token operator">:</span> __dirname <span class="token operator">+</span> <span class="token string">&quot;/dist&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// css</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span> app<span class="token operator">:</span> <span class="token string">&quot;./scr/app.js&quot;</span><span class="token punctuation">,</span> search<span class="token operator">:</span> <span class="token string">&quot;./src/search.js&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span> filename<span class="token operator">:</span> <span class="token string">&quot;[name][chunkhash:8].js&quot;</span><span class="token punctuation">,</span> path<span class="token operator">:</span> __dirname <span class="token operator">+</span> <span class="token string">&quot;/dist&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span> filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[name][contenthash:8].css</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 图片</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span> filename<span class="token operator">:</span> <span class="token string">&quot;bundle.js&quot;</span><span class="token punctuation">,</span> path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|svg|jpg|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">&quot;file-loader&quot;</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;img/[name][hash:8].[ext]&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="vite"><a href="#vite" class="header-anchor">#</a> vite</h2> <ul><li><p><a href="https://www.zhihu.com/question/477139054/answer/2156019180" target="_blank" rel="noopener noreferrer">vite 多久后能干掉 webpack？- 尤雨溪的回答<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>Vite 核心</p> <ul><li>源码部分：是基于浏览器原生的 ES Module，在浏览器请求源码时进行转换</li> <li>依赖部分：使用 esbuild 对 ts、jsx、js 代码进行转换</li> <li>HMR 部分：也是基于 ESModule，源码是协商缓存，依赖模块是强缓存</li> <li>生产环境：用 Rollup 打包代码，因为 esbuild 代码分割和 CSS 还不成熟。</li></ul></li> <li><p>Webpack 和 Vite 的区别</p> <ul><li>Webpack 会先打包整个应用，然后启动开发服务器，请求服务器时直接给予打包结果。</li> <li>Vite 是直接启动开发服务器，请求哪个模块再对该模块进行实时编译，不需要分析模块的依赖、不需要编译。因此启动速度非常快。
<img src="/assets/img/webpack-vite-1.9affcc87.png" alt=""> <img src="/assets/img/webpack-vite-2.916a6df6.png" alt=""></li></ul></li> <li><p>esbuild</p> <ul><li>esbuild 是一个「JavaScript」Bundler 打包和压缩工具，支持压缩、Tree-shaking、sourcemap。</li> <li>使用 GO 语言编写，全部实现机器码，性能快，比其他 JS 写的编译工具快几十倍</li></ul></li> <li><p>如何选择</p> <ul><li>开发环境使用 Vite 快速调试，生产环境依旧使用 Webpack 打包。</li> <li>风险是开发和生产编译产物不一致，这一块需要上线前回归测试避免。</li></ul></li></ul> <h2 id="参考阅读"><a href="#参考阅读" class="header-anchor">#</a> 参考阅读</h2> <ul><li><a href="https://juejin.cn/post/6844904093463347208#heading-0" target="_blank" rel="noopener noreferrer">掘金-webpack 优化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844903728374546445#heading-9" target="_blank" rel="noopener noreferrer">掘金-拆包实践<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844904094281236487#heading-0" target="_blank" rel="noopener noreferrer">掘金-webpack 常见问题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/wallstreetcn/webpack-and-spa-guide" target="_blank" rel="noopener noreferrer">Webpack 4 和单页应用入门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pages/folder1/react.html" class="prev">
        框架-React
      </a></span> <span class="next"><a href="/pages/folder1/normalize.html">
        前端规范
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d50c72b0.js" defer></script><script src="/assets/js/2.7285e602.js" defer></script><script src="/assets/js/13.c032609a.js" defer></script>
  </body>
</html>
